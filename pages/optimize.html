{% extends "partials/base.html" %}
{% block title %}Resume Analysis - AI Resume Coach{% endblock %}

{% block content %}
<div class="page-optimize">
    <div class="container">
        
        <!-- Step 1: Resume Upload (Primary) -->
        <div class="upload-card primary-card">
            <div class="card-header">
                <div class="step-indicator">Step 1 of 2</div>
                <div class="card-title">
                    <h2>Upload Your Resume</h2>
                    <p>Upload your resume. We'll check ATS compatibility and keyword matches.</p>
                </div>
                <div class="card-status" id="resume-status">
                    <i class="fas fa-circle"></i>
                </div>
            </div>

            <!-- Upload Options -->
            <div class="upload-tabs">
                <button type="button" class="tab-option active" data-option="file" onclick="switchUploadOption('file')">
                    <i class="fas fa-cloud-upload"></i>
                    Upload File
                </button>
                <button type="button" class="tab-option" data-option="text" onclick="switchUploadOption('text')">
                    <i class="fas fa-edit"></i>
                    Paste Text
                </button>
            </div>

            <!-- File Upload -->
            <div class="upload-area" id="file-upload-area">
                <div class="drop-zone" id="drop-zone">
                    <div class="drop-content">
                        <i class="fas fa-cloud-upload-alt fa-2x"></i>
                        <h3>Drag & drop your resume here</h3>
                        <p>or <button type="button" class="link-btn" id="browse-btn">choose from computer</button></p>
                        <div class="file-formats">PDF, DOCX, TXT • Max 5MB</div>
                    </div>
                </div>
                <input type="file" id="file-input" accept=".pdf,.docx,.txt" hidden>
                <div id="file-success" class="upload-success" style="display: none;"></div>
            </div>

            <!-- Text Upload -->
            <div class="upload-area" id="text-upload-area" style="display: none;">
                <div class="text-input-wrapper">
                    <textarea id="resume-text" placeholder="Paste your complete resume text here...

Example:
Alex Johnson
Senior Software Engineer
alex.johnson@email.com | (555) 123-4567

PROFESSIONAL EXPERIENCE

Senior Software Engineer | TechCorp Inc. | 2021-Present
• Led development of microservices architecture serving 2M+ users daily
• Reduced system response time by 45% through performance optimization
• Mentored team of 6 engineers and established code review best practices
• Technologies: Python, React, PostgreSQL, AWS, Docker

Software Engineer | StartupXYZ | 2019-2021
• Built scalable web applications using modern JavaScript frameworks
• Implemented CI/CD pipelines reducing deployment time by 60%
• Collaborated with product team on user experience improvements

CORE SKILLS
Languages: Python, JavaScript, TypeScript, Java
Frameworks: React, Node.js, Django, Flask
Tools: Git, Docker, AWS, Jenkins, PostgreSQL" rows="14"></textarea>
                    <div class="char-count" id="char-count">0 characters</div>
                </div>
            </div>

            <div class="upload-help">
                <i class="fas fa-shield-alt"></i>
                Your resume is processed securely and deleted after analysis.
            </div>
        </div>

        <!-- Step 2: Target Job (Secondary/Collapsible) -->
        <div class="upload-card secondary-card">
            <div class="card-header" onclick="toggleJobSection()">
                <div class="step-indicator">Step 2 of 2 (Optional)</div>
                <div class="card-title">
                    <h2>Add Target Job <span class="expand-icon" id="expand-icon"><i class="fas fa-plus"></i></span></h2>
                    <p>Adding a job helps us match your resume more accurately.</p>
                </div>
                <div class="card-status" id="job-status">
                    <span class="optional-label">Optional</span>
                </div>
            </div>

            <!-- Collapsible Job Content -->
            <div class="job-content" id="job-content" style="display: none;">
                <div class="job-input-section">
                    <div class="form-group">
                        <label for="job-title">Job Title</label>
                        <input type="text" id="job-title" class="form-input" placeholder="e.g., Senior Software Engineer">
                    </div>
                    
                    <div class="form-group">
                        <label for="job-description">Job Description</label>
                        <textarea id="job-description" rows="8" class="form-input" 
                            placeholder="Paste the complete job posting here...

We are looking for a Senior Software Engineer to join our growing engineering team...

RESPONSIBILITIES:
• Design and develop scalable web applications
• Lead technical architecture decisions
• Mentor junior developers and conduct code reviews
• Collaborate with product and design teams

REQUIREMENTS:
• 5+ years of software development experience
• Strong proficiency in Python and JavaScript
• Experience with cloud platforms (AWS, Azure, or GCP)
• Bachelor's degree in Computer Science or equivalent"></textarea>
                        <div class="char-count" id="job-char-count">0 characters</div>
                    </div>
                </div>

                <div class="upload-help">
                    <i class="fas fa-bullseye"></i>
                    We'll analyze keyword matches and highlight transferable skills for this specific role.
                </div>
            </div>
        </div>

    </div>

    <!-- Sticky CTA -->
    <div class="sticky-cta">
        <div class="cta-content">
            <button type="button" class="btn btn-primary btn-cta" id="analyze-btn" disabled onclick="startOptimization()">
                <i class="fas fa-magic"></i>
                <span id="cta-text">Analyze My Resume</span>
            </button>
            <div class="cta-help">Get insights in under 30 seconds</div>
        </div>
    </div>

    <!-- Messages -->
    <div id="messages" class="messages-container"></div>

</div>
{% endblock %}

{% block extra_js %}
<!-- Include optimization API integration -->
<script src="{{ url_for('static', filename='js/optimization.js') }}"></script>
{% endblock %}