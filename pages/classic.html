{% extends "partials/base_resume.html" %}

{% block title %} {{ resume.contact.name|default('Resume') }} {% endblock %}

{% block resume_content %}


    <!-- Header -->
    <div class="resume-header content-editable">
      <h1 class="name" contenteditable="true">{{ resume.contact.name|default('John Doe') }}</h1>
      <h2 class="title" contenteditable="true">{{ resume.title|default('Professional Title') }}</h2>
      
      {% if resume.contact %}
      <div class="contact-grid">
        {% if resume.contact.email %}
        <div class="contact-item content-editable">
          <i class="contact-icon fas fa-envelope"></i>
          <span class="contact-content" contenteditable="true">{{ resume.contact.email }}</span>
        </div>
        {% endif %}
        
        {% if resume.contact.phone %}
        <div class="contact-item content-editable">
          <i class="contact-icon fas fa-phone"></i>
          <span class="contact-content" contenteditable="true">{{ resume.contact.phone }}</span>
        </div>
        {% endif %}
        
        {% if resume.contact.location %}
        <div class="contact-item content-editable">
          <i class="contact-icon fas fa-map-marker-alt"></i>
          <span class="contact-content" contenteditable="true">{{ resume.contact.location }}</span>
        </div>
        {% endif %}
        
        {% if resume.contact.linkedin %}
        <div class="contact-item content-editable">
          <i class="contact-icon fab fa-linkedin"></i>
          <span class="contact-content" contenteditable="true">{{ resume.contact.linkedin }}</span>
        </div>
        {% endif %}
        
        {% if resume.contact.website %}
        <div class="contact-item content-editable">
          <i class="contact-icon fas fa-globe"></i>
          <span class="contact-content" contenteditable="true">{{ resume.contact.website }}</span>
        </div>
        {% endif %}
      </div>
      {% endif %}
    </div>

    <!-- Custom Sections -->
    {% for section in resume.sections %}
    <section class="resume-section {{ section.type }}-section">
      <h2 class="section-title" contenteditable="true">
        {% set map = {'summary':'user','experience':'briefcase', 'education':'graduation-cap','skills':'cogs','star':'star'} %}
        {% if section.type in map  %}
          <i class="fas fa-{{ map[section.type]}}"></i>
        {% else %}
          <i class="fas fa-{{ map['star']}}"></i>
        {% endif %}
        {{ section.title }}
      </h2>
      
      {% if section.display == 'text' %}
        <div class="section-content" contenteditable="true">
          {{ section.content | safe }}
        </div>
      
      {% elif section.display == 'tags' %}
        <div class="section-container">
          {% for item in section["items"] %}
            <span class="section-tag">
              <i class="fas fa-check"></i>
              {{ item }}
              <i class="fas fa-times tag-delete"></i>
            </span>
          {% endfor %}
          <button class="add-tag-btn" id="add-{{section.type}}-btn">
            <i class="fas fa-plus"></i> Add {{section.type}}
          </button>
        </div>
      
      {% else %}
        {% for item in section["items"] %}
          <div class="section-item">
            <div class="item-actions">
              <button class="item-btn move-up" title="Move Up"><i class="fas fa-arrow-up"></i></button>
              <button class="item-btn move-down" title="Move Down"><i class="fas fa-arrow-down"></i></button>
              <button class="item-btn delete" title="Delete"><i class="fas fa-trash"></i></button>
            </div>
            
            {% for key, value in item.items() %}
              <div class="section-{{ key | replace('_', '-') }}" contenteditable="true" data-key="{{ key }}">
                {% if key == 'name' or key == 'job_title' or key == 'degree' %}
                  <i class="fas fa-chevron-right"></i>
                {% elif key == 'company' or key == 'school' or key == 'issuer' %}
                  <i class="fas fa-building"></i>
                {% elif key == 'date' or key == 'duration' %}
                  <i class="fas fa-calendar-alt"></i>
                {% endif %}
                {{ value }}
              </div>
            {% endfor %}
          </div>
        {% endfor %}
        {% if section.type != "skills" and section.type != "summary" %}
        <button class="add-item-btn" id="add-{{section.type}}-btn">
          <i class="fas fa-plus"></i> Add {{section.type}}
        </button>
        {% endif %}
      {% endif %}
    </section>
    {% endfor %}

    <!-- ATS Score Button -->
    <button class="ats-score-btn" data-action="ats-scan">
      <i class="fas fa-robot"></i> Check ATS Score
    </button>

    <!-- AI Assistant Modal -->
    <div class="ai-modal" id="ai-assistant-modal">
      <div class="ai-modal-content">
        <div class="ai-modal-header">
          <h3 class="ai-modal-title">AI Assistant</h3>
          <button class="ai-modal-close">&times;</button>
        </div>
        <div class="ai-modal-body">
          <div class="ai-assistant-menu">
            <h4>How can I help improve your resume?</h4>
            <div class="ai-feature-cards">
              <div class="ai-feature-card" data-action="generate-summary">
                <div class="ai-feature-icon"><i class="fas fa-magic"></i></div>
                <div class="ai-feature-text">
                  <h5>Generate Summary</h5>
                  <p>Create a professional summary based on your experience</p>
                </div>
              </div>
              <div class="ai-feature-card" data-action="enhance-bullets">
                <div class="ai-feature-icon"><i class="fas fa-star"></i></div>
                <div class="ai-feature-text">
                  <h5>Enhance Experience</h5>
                  <p>Improve your work experience bullet points</p>
                </div>
              </div>
              <div class="ai-feature-card" data-action="suggest-skills">
                <div class="ai-feature-icon"><i class="fas fa-lightbulb"></i></div>
                <div class="ai-feature-text">
                  <h5>Suggest Skills</h5>
                  <p>Recommend relevant skills based on your background</p>
                </div>
              </div>
              <div class="ai-feature-card" data-action="tailor-to-job">
                <div class="ai-feature-icon"><i class="fas fa-bullseye"></i></div>
                <div class="ai-feature-text">
                  <h5>Tailor to Job</h5>
                  <p>Customize your resume for a specific job description</p>
                </div>
              </div>
              <div class="ai-feature-card" data-action="ats-scan">
                <div class="ai-feature-icon"><i class="fas fa-robot"></i></div>
                <div class="ai-feature-text">
                  <h5>ATS Optimization</h5>
                  <p>Check and improve ATS compatibility</p>
                </div>
              </div>
              <div class="ai-feature-card" data-action="extract-skills">
                <div class="ai-feature-icon"><i class="fas fa-clipboard-check"></i></div>
                <div class="ai-feature-text">
                  <h5>Extract Skills</h5>
                  <p>Extract skills from your work experience</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
{% endblock %}