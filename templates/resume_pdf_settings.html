
{% extends "base.html" %}
{% block title %}PDF Export Settings - ResumeMatch{% endblock %}
{% block content %}
<!-- Navigation Bar -->
{% include 'partials/navbar.html' with context %}
<section class="resume-preview-section">
    <div class="container">
        <div class="preview-header">
            <a href="{{ url_for('resume_preview', resume_id=resume.id) }}" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Resume
            </a>



<div class="header-actions">
    <a href="{{ url_for('preview_pdf', resume_id=resume.id) }}" class="btn-preview" target="_blank">
        <i class="fas fa-eye"></i> Preview PDF
    </a>
</div>
</div>

<div class="pdf-settings-container">
<h1 class="settings-title">PDF Export Settings</h1>
<p class="settings-description">Customize how your resume will appear when exported as a PDF.</p>

<form method="POST" class="pdf-settings-form" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="settings-section">
        <h2 class="section-title">Template Selection</h2>
        
        <div class="templates-grid">
            {% for template_id, template in templates.items() %}
            <div class="template-option">
                <input type="radio" name="template" id="template-{{ template_id }}" 
                       value="{{ template_id }}" {% if resume.template == template_id %}checked{% endif %}>
                <label for="template-{{ template_id }}" class="template-label">
                    <div class="template-preview {{ template.css_class }}">
                        <div class="template-header"></div>
                        <div class="template-content">
                            <div class="template-line"></div>
                            <div class="template-line"></div>
                            <div class="template-line short"></div>
                        </div>
                    </div>
                    <div class="template-info">
                        <h3>{{ template.name }}</h3>
                        <p>{{ template.description }}</p>
                    </div>
                </label>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div class="settings-section">
        <h2 class="section-title">Profile Photo</h2>
        <p class="section-description">Add a professional photo to your resume (optional).</p>
        
        <div class="photo-upload-container">
            <div class="current-photo">
                <div class="photo-preview" id="photo-preview">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            
            <div class="photo-upload">
                <label for="profile-image" class="file-upload-label">
                    <i class="fas fa-upload"></i> Upload Photo
                </label>
                <input type="file" id="profile-image" name="profile_image" 
                       accept="image/jpeg, image/png, image/gif" class="file-upload-input">
                <p class="upload-note">Recommended: Square image, professional appearance</p>
                
                <button type="button" id="remove-photo" class="btn-remove-photo" style="display: none;">
                    <i class="fas fa-trash-alt"></i> Remove Photo
                </button>
            </div>
        </div>
    </div>
    
    <div class="form-actions">
        <a href="{{ url_for('resume_preview', resume_id=resume.id) }}" class="btn btn-outline">Cancel</a>
        <button type="submit" class="btn btn-primary">Generate PDF</button>
    </div>
</form>
</div>
</div>

</section>
{% endblock %}
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Profile image preview functionality
        const profileInput = document.getElementById('profile-image');
        const photoPreview = document.getElementById('photo-preview');
        const removePhotoBtn = document.getElementById('remove-photo');
        
        profileInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    // Clear the placeholder icon
                    photoPreview.innerHTML = '';
                    
                    // Create image element
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'photo-img';
                    photoPreview.appendChild(img);
                    
                    // Show remove button
                    removePhotoBtn.style.display = 'block';
                };
                
                reader.readAsDataURL(this.files[0]);
            }
        });
        
        // Remove photo functionality
        removePhotoBtn.addEventListener('click', function() {
            // Clear the input
            profileInput.value = '';
            
            // Reset preview
            photoPreview.innerHTML = '<i class="fas fa-user"></i>';
            
            // Hide remove button
            this.style.display = 'none';
        });
        
        // Template selection highlighting
        const templateRadios = document.querySelectorAll('input[name="template"]');
        const templateLabels = document.querySelectorAll('.template-label');
        
        templateRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                // Remove active class from all labels
                templateLabels.forEach(label => {
                    label.classList.remove('active');
                });
                
                // Add active class to selected template
                if (this.checked) {
                    document.querySelector(`label[for="${this.id}"]`).classList.add('active');
                }
            });
        });
        
        // Initially set active class for selected template
        document.querySelectorAll('input[name="template"]:checked').forEach(radio => {
            document.querySelector(`label[for="${radio.id}"]`).classList.add('active');
        });
    });
</script>
{% endblock %}